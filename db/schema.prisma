datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

generator py_client {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = 5
}

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  hashed_password String
  is_active     Boolean   @default(true)
  is_superuser  Boolean   @default(false)
  is_verified   Boolean   @default(false)
  
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  logs          AsceticismLog[]
  focusedViceId String?
  focusedVice   Vice?     @relation(fields: [focusedViceId], references: [id])
}

model Vice {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  category    String?  // e.g., "Root Sin", "Capital Vice"
  
  usersFocusing User[]
  logs          AsceticismLog[]
}

model AsceticismCategory {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  
  logs        AsceticismLog[]
}

model AsceticismLog {
  id            String   @id @default(uuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id])
  
  date          DateTime @default(now()) // Can be just date without time part in logic
  completed     Boolean  @default(false)
  notes         String?
  
  categoryId    String?
  category      AsceticismCategory? @relation(fields: [categoryId], references: [id])
  
  viceId        String?
  vice          Vice?    @relation(fields: [viceId], references: [id])

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}
